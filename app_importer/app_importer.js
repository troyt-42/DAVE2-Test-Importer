var importer = angular.module("importer", ["ngAnimate", "selectionComponent", "menuComponent","columnComponent", "dropBoxComponent","panelComponent",'angularFileUpload', 'btford.socket-io']);


importer.factory("daveFormatService", function(){
  return {
    selectionFieldsDataDFS : function(placeToStore, fileName, fieldsNames){
      placeToStore[fileName] = fieldsNames;
    },
    dropBoxMetaDFS : function (field, detail, value){
      var option = {};
      option[field] = {};
      option[field][detail] = value;
      return option;
    }
  };
});

importer.factory('uploadSocket',function(socketFactory){
	var socket = io.connect('http://10.3.86.65:3000/');

	return socketFactory({
		ioSocket: socket
	});
});

importer.controller("importerCtrl", ["$scope", "$http", "FileUploader", "daveFormatService",'uploadSocket', function($scope, $http, FileUploader,daveFormatService, uploadSocket){

  var username = {username : prompt("Please input your username.")};
  $http.post('http:///10.3.86.65:3000/username', username).success(function() {
    console.log("success!");
  }).
  error(function(status) {
    console.log(status);
  });


  $scope.uploader = new FileUploader({url : "http:///10.3.86.65:3000/upload", removeAfterUpload : false});


  $scope.formattedData = [
  {
      "Meta" : {
          "item_id" : "7",
          "Name":"CH DRYER_C_SRP.FIC16107.MEAS",
          "Location":"Chatham",
          "Area":"DRYER_C_SRPS",
          "Unit":"meters cubed per hour",
          "Number Type" : "Single Float",
          "Anything" : "Random1",
          "Description":"Chatham - DRYER_C_SRP - FIC16107.MEAS"
      },
      "data" :  {
          "01/01/2014":"0.000001",
          "01/02/2014":"2",
          "01/03/2014":"3",
          "01/04/2014":"4",
          "01/05/2014":"5",
          "01/06/2014":"6",
          "01/07/2014":"7.333333",
          "01/08/2014":"8.47619",
          "01/09/2014":"9.619047",
          "01/10/2014":"10.761904",
          "01/11/2014":"11.904761",
          "01/12/2014":"13.047618",
          "01/13/2014":"14.190475",
          "01/14/2014":"15.333332",
          "01/15/2014":"16.476189",
          "01/16/2014":"17.619046",
          "01/17/2014":"18.761903",
          "01/18/2014":"19.90476",
          "01/19/2014":"21.047617",
          "01/20/2014":"22.190474",
          "01/21/2014":"23.333331",
          "01/22/2014":"24.476188",
          "01/23/2014":"25.619045",
          "01/24/2014":"26.761902",
          "01/25/2014":"27.904759",
          "01/26/2014":"29.047616",
          "01/27/2014":"30.190473",
          "01/28/2014":"31.33333",
          "01/29/2014":"32.476187",
          "01/30/2014":"33.619044",
          "01/31/2014":"34.761901",
          "02/01/2014":"35.904758",
          "02/02/2014":"37.047615",
          "02/03/2014":"38.190472",
          "02/04/2014":"39.333329",
          "02/05/2014":"40.476186",
          "02/06/2014":"41.619043",
          "02/07/2014":"42.7619",
          "02/08/2014":"43.904757",
          "02/09/2014":"45.047614",
          "02/10/2014":"46.190471",
          "02/11/2014":"47.333328",
          "02/12/2014":"48.476185",
          "02/13/2014":"49.619042",
          "02/14/2014":"50.761899",
          "02/15/2014":"51.904756",
          "02/16/2014":"53.047613",
          "02/17/2014":"54.19047",
          "02/18/2014":"55.333327",
          "02/19/2014":"56.476184",
          "02/20/2014":"57.619041",
          "02/21/2014":"58.761898",
          "02/22/2014":"59.904755",
          "02/23/2014":"61.047612",
          "02/24/2014":"62.190469",
          "02/25/2014":"63.333326",
          "02/26/2014":"64.476183",
          "02/27/2014":"65.61904",
          "02/28/2014":"66.761897",
          "03/01/2014":"67.904754",
          "03/02/2014":"69.047611",
          "03/03/2014":"70.190468",
          "03/04/2014":"71.333325",
          "03/05/2014":"72.476182",
          "03/06/2014":"73.619039",
          "03/07/2014":"74.761896",
          "03/08/2014":"75.904753",
          "03/09/2014":"77.04761",
          "03/10/2014":"78.190467",
          "03/11/2014":"79.333324",
          "03/12/2014":"80.476181",
          "03/13/2014":"81.619038",
          "03/14/2014":"82.761895",
          "03/15/2014":"83.904752",
          "03/16/2014":"85.047609",
          "03/17/2014":"86.190466",
          "03/18/2014":"87.333323",
          "03/19/2014":"88.47618",
          "03/20/2014":"89.619037",
          "03/21/2014":"90.761894",
          "03/22/2014":"91.904751",
          "03/23/2014":"93.047608",
          "03/24/2014":"94.190465",
          "03/25/2014":"95.333322",
          "03/26/2014":"96.476179",
          "03/27/2014":"97.619036",
          "03/28/2014":"98.761893",
          "03/29/2014":"99.90475",
          "03/30/2014":"101.047607",
          "03/31/2014":"102.190464",
          "04/01/2014":"103.333321",
          "04/02/2014":"104.476178",
          "04/03/2014":"105.619035",
          "04/04/2014":"106.761892",
          "04/05/2014":"107.904749",
          "04/06/2014":"109.047606",
          "04/07/2014":"110.190463",
          "04/08/2014":"111.33332",
          "04/09/2014":"112.476177",
          "04/10/2014":"113.619034",
          "04/11/2014":"114.761891",
          "04/12/2014":"115.904748",
          "04/13/2014":"117.047605",
          "04/14/2014":"118.190462",
          "04/15/2014":"119.333319",
          "04/16/2014":"120.476176",
          "04/17/2014":"121.619033",
          "04/18/2014":"122.76189",
          "04/19/2014":"123.904747",
          "04/20/2014":"125.047604",
          "04/21/2014":"126.190461",
          "04/22/2014":"127.333318",
          "04/23/2014":"128.476175",
          "04/24/2014":"129.619032",
          "04/25/2014":"130.761889",
          "04/26/2014":"131.904746",
          "04/27/2014":"133.047603",
          "04/28/2014":"134.19046",
          "04/29/2014":"135.333317",
          "04/30/2014":"136.476174",
          "05/01/2014":"137.619031",
          "05/02/2014":"138.761888",
          "05/03/2014":"139.904745",
          "05/04/2014":"141.047602",
          "05/05/2014":"142.190459",
          "05/06/2014":"143.333316",
          "05/07/2014":"144.476173",
          "05/08/2014":"145.61903",
          "05/09/2014":"146.761887",
          "05/10/2014":"147.904744",
          "05/11/2014":"149.047601",
          "05/12/2014":"150.190458",
          "05/13/2014":"151.333315",
          "05/14/2014":"152.476172",
          "05/15/2014":"153.619029",
          "05/16/2014":"154.761886",
          "05/17/2014":"155.904743",
          "05/18/2014":"157.0476",
          "05/19/2014":"158.190457",
          "05/20/2014":"159.333314",
          "05/21/2014":"160.476171",
          "05/22/2014":"161.619028",
          "05/23/2014":"162.761885",
          "05/24/2014":"163.904742",
          "05/25/2014":"165.047599",
          "05/26/2014":"166.190456",
          "05/27/2014":"167.333313",
          "05/28/2014":"168.47617",
          "05/29/2014":"169.619027",
          "05/30/2014":"170.761884",
          "05/31/2014":"171.904741",
          "06/01/2014":"173.047598",
          "06/02/2014":"174.190455",
          "06/03/2014":"175.333312",
          "06/04/2014":"176.476169",
          "06/05/2014":"177.619026",
          "06/06/2014":"178.761883",
          "06/07/2014":"179.90474",
          "06/08/2014":"181.047597",
          "06/09/2014":"182.190454",
          "06/10/2014":"183.333311",
          "06/11/2014":"184.476168",
          "06/12/2014":"185.619025",
          "06/13/2014":"186.761882",
          "06/14/2014":"187.904739",
          "06/15/2014":"189.047596",
          "06/16/2014":"190.190453",
          "06/17/2014":"191.33331",
          "06/18/2014":"192.476167",
          "06/19/2014":"193.619024",
          "06/20/2014":"194.761881",
          "06/21/2014":"195.904738",
          "06/22/2014":"197.047595",
          "06/23/2014":"198.190452",
          "06/24/2014":"199.333309",
          "06/25/2014":"200.476166",
          "06/26/2014":"201.619023",
          "06/27/2014":"202.76188",
          "06/28/2014":"203.904737",
          "06/29/2014":"205.047594",
          "06/30/2014":"206.190451",
          "07/01/2014":"207.333308",
          "07/02/2014":"208.476165",
          "07/03/2014":"209.619022",
          "07/04/2014":"210.761879",
          "07/05/2014":"211.904736",
          "07/06/2014":"213.047593",
          "07/07/2014":"214.19045",
          "07/08/2014":"215.333307",
          "07/09/2014":"216.476164",
          "07/10/2014":"217.619021",
          "07/11/2014":"218.761878",
          "07/12/2014":"219.904735",
          "07/13/2014":"221.047592",
          "07/14/2014":"222.190449",
          "07/15/2014":"223.333306",
          "07/16/2014":"224.476163",
          "07/17/2014":"225.61902",
          "07/18/2014":"226.761877",
          "07/19/2014":"227.904734",
          "07/20/2014":"229.047591",
          "07/21/2014":"230.190448",
          "07/22/2014":"231.333305",
          "07/23/2014":"232.476162"
        }
  },

  {
      "Meta" : {
          "item_id" : "8",
          "Name":"CH FERMENT_4.TT14502.PNT",
          "Location":"Chatham",
          "Area":"FERMENT_4",
          "Unit":"Unknown",
          "Number Type" : "Integer",
          "Anything" : "Random2",
          "Description":"Chatham - FERMENT_4 - TT14502.PNT"
      },
      "data" :  {
      "01/01/2014":"0.0000001",
      "01/02/2014":"0.2",
      "01/03/2014":"0.3",
      "01/04/2014":"0.4",
      "01/05/2014":"0.5",
      "01/06/2014":"0.6",
      "01/07/2014":"0.7333333",
      "01/08/2014":"0.847619",
      "01/09/2014":"0.9619047",
      "01/10/2014":"1.0761904",
      "01/11/2014":"1.1904761",
      "01/12/2014":"1.3047618",
      "01/13/2014":"1.4190475",
      "01/14/2014":"1.5333332",
      "01/15/2014":"1.6476189",
      "01/16/2014":"1.7619046",
      "01/17/2014":"1.8761903",
      "01/18/2014":"1.990476",
      "01/19/2014":"2.1047617",
      "01/20/2014":"2.2190474",
      "01/21/2014":"2.3333331",
      "01/22/2014":"2.4476188",
      "01/23/2014":"2.5619045",
      "01/24/2014":"2.6761902",
      "01/25/2014":"2.7904759",
      "01/26/2014":"2.9047616",
      "01/27/2014":"3.0190473",
      "01/28/2014":"3.133333",
      "01/29/2014":"3.2476187",
      "01/30/2014":"3.3619044",
      "01/31/2014":"3.4761901",
      "02/01/2014":"3.5904758",
      "02/02/2014":"3.7047615",
      "02/03/2014":"3.8190472",
      "02/04/2014":"3.9333329",
      "02/05/2014":"4.0476186",
      "02/06/2014":"4.1619043",
      "02/07/2014":"4.27619",
      "02/08/2014":"4.3904757",
      "02/09/2014":"4.5047614",
      "02/10/2014":"4.6190471",
      "02/11/2014":"4.7333328",
      "02/12/2014":"4.8476185",
      "02/13/2014":"4.9619042",
      "02/14/2014":"5.0761899",
      "02/15/2014":"5.1904756",
      "02/16/2014":"5.3047613",
      "02/17/2014":"5.419047",
      "02/18/2014":"5.5333327",
      "02/19/2014":"5.6476184",
      "02/20/2014":"5.7619041",
      "02/21/2014":"5.8761898",
      "02/22/2014":"5.9904755",
      "02/23/2014":"6.1047612",
      "02/24/2014":"6.2190469",
      "02/25/2014":"6.3333326",
      "02/26/2014":"6.4476183",
      "02/27/2014":"6.561904",
      "02/28/2014":"6.6761897",
      "03/01/2014":"6.7904754",
      "03/02/2014":"6.9047611",
      "03/03/2014":"7.0190468",
      "03/04/2014":"7.1333325",
      "03/05/2014":"7.2476182",
      "03/06/2014":"7.3619039",
      "03/07/2014":"7.4761896",
      "03/08/2014":"7.5904753",
      "03/09/2014":"7.704761",
      "03/10/2014":"7.8190467",
      "03/11/2014":"7.9333324",
      "03/12/2014":"8.0476181",
      "03/13/2014":"8.1619038",
      "03/14/2014":"8.2761895",
      "03/15/2014":"8.3904752",
      "03/16/2014":"8.5047609",
      "03/17/2014":"8.6190466",
      "03/18/2014":"8.7333323",
      "03/19/2014":"8.847618",
      "03/20/2014":"8.9619037",
      "03/21/2014":"9.0761894",
      "03/22/2014":"9.1904751",
      "03/23/2014":"9.3047608",
      "03/24/2014":"9.4190465",
      "03/25/2014":"9.5333322",
      "03/26/2014":"9.6476179",
      "03/27/2014":"9.7619036",
      "03/28/2014":"9.8761893",
      "03/29/2014":"9.990475",
      "03/30/2014":"10.1047607",
      "03/31/2014":"10.2190464",
      "04/01/2014":"10.3333321",
      "04/02/2014":"10.4476178",
      "04/03/2014":"10.5619035",
      "04/04/2014":"10.6761892",
      "04/05/2014":"10.7904749",
      "04/06/2014":"10.9047606",
      "04/07/2014":"11.0190463",
      "04/08/2014":"11.133332",
      "04/09/2014":"11.2476177",
      "04/10/2014":"11.3619034",
      "04/11/2014":"11.4761891",
      "04/12/2014":"11.5904748",
      "04/13/2014":"11.7047605",
      "04/14/2014":"11.8190462",
      "04/15/2014":"11.9333319",
      "04/16/2014":"12.0476176",
      "04/17/2014":"12.1619033",
      "04/18/2014":"12.276189",
      "04/19/2014":"12.3904747",
      "04/20/2014":"12.5047604",
      "04/21/2014":"12.6190461",
      "04/22/2014":"12.7333318",
      "04/23/2014":"12.8476175",
      "04/24/2014":"12.9619032",
      "04/25/2014":"13.0761889",
      "04/26/2014":"13.1904746",
      "04/27/2014":"13.3047603",
      "04/28/2014":"13.419046",
      "04/29/2014":"13.5333317",
      "04/30/2014":"13.6476174",
      "05/01/2014":"13.7619031",
      "05/02/2014":"13.8761888",
      "05/03/2014":"13.9904745",
      "05/04/2014":"14.1047602",
      "05/05/2014":"14.2190459",
      "05/06/2014":"14.3333316",
      "05/07/2014":"14.4476173",
      "05/08/2014":"14.561903",
      "05/09/2014":"14.6761887",
      "05/10/2014":"14.7904744",
      "05/11/2014":"14.9047601",
      "05/12/2014":"15.0190458",
      "05/13/2014":"15.1333315",
      "05/14/2014":"15.2476172",
      "05/15/2014":"15.3619029",
      "05/16/2014":"15.4761886",
      "05/17/2014":"15.5904743",
      "05/18/2014":"15.70476",
      "05/19/2014":"15.8190457",
      "05/20/2014":"15.9333314",
      "05/21/2014":"16.0476171",
      "05/22/2014":"16.1619028",
      "05/23/2014":"16.2761885",
      "05/24/2014":"16.3904742",
      "05/25/2014":"16.5047599",
      "05/26/2014":"16.6190456",
      "05/27/2014":"16.7333313",
      "05/28/2014":"16.847617",
      "05/29/2014":"16.9619027",
      "05/30/2014":"17.0761884",
      "05/31/2014":"17.1904741",
      "06/01/2014":"17.3047598",
      "06/02/2014":"17.4190455",
      "06/03/2014":"17.5333312",
      "06/04/2014":"17.6476169",
      "06/05/2014":"17.7619026",
      "06/06/2014":"17.8761883",
      "06/07/2014":"17.990474",
      "06/08/2014":"18.1047597",
      "06/09/2014":"18.2190454",
      "06/10/2014":"18.3333311",
      "06/11/2014":"18.4476168",
      "06/12/2014":"18.5619025",
      "06/13/2014":"18.6761882",
      "06/14/2014":"18.7904739",
      "06/15/2014":"18.9047596",
      "06/16/2014":"19.0190453",
      "06/17/2014":"19.133331",
      "06/18/2014":"19.2476167",
      "06/19/2014":"19.3619024",
      "06/20/2014":"19.4761881",
      "06/21/2014":"19.5904738",
      "06/22/2014":"19.7047595",
      "06/23/2014":"19.8190452",
      "06/24/2014":"19.9333309",
      "06/25/2014":"20.0476166",
      "06/26/2014":"20.1619023",
      "06/27/2014":"20.276188",
      "06/28/2014":"20.3904737",
      "06/29/2014":"20.5047594",
      "06/30/2014":"20.6190451",
      "07/01/2014":"20.7333308",
      "07/02/2014":"20.8476165",
      "07/03/2014":"20.9619022",
      "07/04/2014":"21.0761879",
      "07/05/2014":"21.1904736",
      "07/06/2014":"21.3047593",
      "07/07/2014":"21.419045",
      "07/08/2014":"21.5333307",
      "07/09/2014":"21.6476164",
      "07/10/2014":"21.7619021",
      "07/11/2014":"21.8761878",
      "07/12/2014":"21.9904735",
      "07/13/2014":"22.1047592",
      "07/14/2014":"22.2190449",
      "07/15/2014":"22.3333306",
      "07/16/2014":"22.4476163",
      "07/17/2014":"22.561902",
      "07/18/2014":"22.6761877",
      "07/19/2014":"22.7904734",
      "07/20/2014":"22.9047591",
      "07/21/2014":"23.0190448",
      "07/22/2014":"23.1333305",
      "07/23/2014":"23.2476162"
        }
  },



  {
      "Meta" : {
          "item_id" : "9",
          "Name":"CH FERMENT_4.FIC14601.MEAST",
          "Location":"Chatham",
          "Area":"FERMENT_4",
          "Unit":"Unknown",
          "Number Type" : "Float1",
          "Anything" : "Random3",
          "Description":"Chatham - FERMENT_4 - FIC14601.MEAS"
      },
      "data" :  {
      "01/01/2014":"0.0000001",
      "01/02/2014":"0.2",
      "01/03/2014":"0.3",
      "01/04/2014":"0.4",
      "01/05/2014":"0.5",
      "01/06/2014":"0.6",
      "01/07/2014":"0.7333333",
      "01/08/2014":"0.847619",
      "01/09/2014":"0.9619047",
      "01/10/2014":"1.0761904",
      "01/11/2014":"1.1904761",
      "01/12/2014":"1.3047618",
      "01/13/2014":"1.4190475",
      "01/14/2014":"1.5333332",
      "01/15/2014":"1.6476189",
      "01/16/2014":"1.7619046",
      "01/17/2014":"1.8761903",
      "01/18/2014":"1.990476",
      "01/19/2014":"2.1047617",
      "01/20/2014":"2.2190474",
      "01/21/2014":"2.3333331",
      "01/22/2014":"2.4476188",
      "01/23/2014":"2.5619045",
      "01/24/2014":"2.6761902",
      "01/25/2014":"2.7904759",
      "01/26/2014":"2.9047616",
      "01/27/2014":"3.0190473",
      "01/28/2014":"3.133333",
      "01/29/2014":"3.2476187",
      "01/30/2014":"3.3619044",
      "01/31/2014":"3.4761901",
      "02/01/2014":"3.5904758",
      "02/02/2014":"3.7047615",
      "02/03/2014":"3.8190472",
      "02/04/2014":"3.9333329",
      "02/05/2014":"4.0476186",
      "02/06/2014":"4.1619043",
      "02/07/2014":"4.27619",
      "02/08/2014":"4.3904757",
      "02/09/2014":"4.5047614",
      "02/10/2014":"4.6190471",
      "02/11/2014":"4.7333328",
      "02/12/2014":"4.8476185",
      "02/13/2014":"4.9619042",
      "02/14/2014":"5.0761899",
      "02/15/2014":"5.1904756",
      "02/16/2014":"5.3047613",
      "02/17/2014":"5.419047",
      "02/18/2014":"5.5333327",
      "02/19/2014":"5.6476184",
      "02/20/2014":"5.7619041",
      "02/21/2014":"5.8761898",
      "02/22/2014":"5.9904755",
      "02/23/2014":"6.1047612",
      "02/24/2014":"6.2190469",
      "02/25/2014":"6.3333326",
      "02/26/2014":"6.4476183",
      "02/27/2014":"6.561904",
      "02/28/2014":"6.6761897",
      "03/01/2014":"6.7904754",
      "03/02/2014":"6.9047611",
      "03/03/2014":"7.0190468",
      "03/04/2014":"7.1333325",
      "03/05/2014":"7.2476182",
      "03/06/2014":"7.3619039",
      "03/07/2014":"7.4761896",
      "03/08/2014":"7.5904753",
      "03/09/2014":"7.704761",
      "03/10/2014":"7.8190467",
      "03/11/2014":"7.9333324",
      "03/12/2014":"8.0476181",
      "03/13/2014":"8.1619038",
      "03/14/2014":"8.2761895",
      "03/15/2014":"8.3904752",
      "03/16/2014":"8.5047609",
      "03/17/2014":"8.6190466",
      "03/18/2014":"8.7333323",
      "03/19/2014":"8.847618",
      "03/20/2014":"8.9619037",
      "03/21/2014":"9.0761894",
      "03/22/2014":"9.1904751",
      "03/23/2014":"9.3047608",
      "03/24/2014":"9.4190465",
      "03/25/2014":"9.5333322",
      "03/26/2014":"9.6476179",
      "03/27/2014":"9.7619036",
      "03/28/2014":"9.8761893",
      "03/29/2014":"9.990475",
      "03/30/2014":"10.1047607",
      "03/31/2014":"10.2190464",
      "04/01/2014":"10.3333321",
      "04/02/2014":"10.4476178",
      "04/03/2014":"10.5619035",
      "04/04/2014":"10.6761892",
      "04/05/2014":"10.7904749",
      "04/06/2014":"10.9047606",
      "04/07/2014":"11.0190463",
      "04/08/2014":"11.133332",
      "04/09/2014":"11.2476177",
      "04/10/2014":"11.3619034",
      "04/11/2014":"11.4761891",
      "04/12/2014":"11.5904748",
      "04/13/2014":"11.7047605",
      "04/14/2014":"11.8190462",
      "04/15/2014":"11.9333319",
      "04/16/2014":"12.0476176",
      "04/17/2014":"12.1619033",
      "04/18/2014":"12.276189",
      "04/19/2014":"12.3904747",
      "04/20/2014":"12.5047604",
      "04/21/2014":"12.6190461",
      "04/22/2014":"12.7333318",
      "04/23/2014":"12.8476175",
      "04/24/2014":"12.9619032",
      "04/25/2014":"13.0761889",
      "04/26/2014":"13.1904746",
      "04/27/2014":"13.3047603",
      "04/28/2014":"13.419046",
      "04/29/2014":"13.5333317",
      "04/30/2014":"13.6476174",
      "05/01/2014":"13.7619031",
      "05/02/2014":"13.8761888",
      "05/03/2014":"13.9904745",
      "05/04/2014":"14.1047602",
      "05/05/2014":"14.2190459",
      "05/06/2014":"14.3333316",
      "05/07/2014":"14.4476173",
      "05/08/2014":"14.561903",
      "05/09/2014":"14.6761887",
      "05/10/2014":"14.7904744",
      "05/11/2014":"14.9047601",
      "05/12/2014":"15.0190458",
      "05/13/2014":"15.1333315",
      "05/14/2014":"15.2476172",
      "05/15/2014":"15.3619029",
      "05/16/2014":"15.4761886",
      "05/17/2014":"15.5904743",
      "05/18/2014":"15.70476",
      "05/19/2014":"15.8190457",
      "05/20/2014":"15.9333314",
      "05/21/2014":"16.0476171",
      "05/22/2014":"16.1619028",
      "05/23/2014":"16.2761885",
      "05/24/2014":"16.3904742",
      "05/25/2014":"16.5047599",
      "05/26/2014":"16.6190456",
      "05/27/2014":"16.7333313",
      "05/28/2014":"16.847617",
      "05/29/2014":"16.9619027",
      "05/30/2014":"17.0761884",
      "05/31/2014":"17.1904741",
      "06/01/2014":"17.3047598",
      "06/02/2014":"17.4190455",
      "06/03/2014":"17.5333312",
      "06/04/2014":"17.6476169",
      "06/05/2014":"17.7619026",
      "06/06/2014":"17.8761883",
      "06/07/2014":"17.990474",
      "06/08/2014":"18.1047597",
      "06/09/2014":"18.2190454",
      "06/10/2014":"18.3333311",
      "06/11/2014":"18.4476168",
      "06/12/2014":"18.5619025",
      "06/13/2014":"18.6761882",
      "06/14/2014":"18.7904739",
      "06/15/2014":"18.9047596",
      "06/16/2014":"19.0190453",
      "06/17/2014":"19.133331",
      "06/18/2014":"19.2476167",
      "06/19/2014":"19.3619024",
      "06/20/2014":"19.4761881",
      "06/21/2014":"19.5904738",
      "06/22/2014":"19.7047595",
      "06/23/2014":"19.8190452",
      "06/24/2014":"19.9333309",
      "06/25/2014":"20.0476166",
      "06/26/2014":"20.1619023",
      "06/27/2014":"20.276188",
      "06/28/2014":"20.3904737",
      "06/29/2014":"20.5047594",
      "06/30/2014":"20.6190451",
      "07/01/2014":"20.7333308",
      "07/02/2014":"20.8476165",
      "07/03/2014":"20.9619022",
      "07/04/2014":"21.0761879",
      "07/05/2014":"21.1904736",
      "07/06/2014":"21.3047593",
      "07/07/2014":"21.419045",
      "07/08/2014":"21.5333307",
      "07/09/2014":"21.6476164",
      "07/10/2014":"21.7619021",
      "07/11/2014":"21.8761878",
      "07/12/2014":"21.9904735",
      "07/13/2014":"22.1047592",
      "07/14/2014":"22.2190449",
      "07/15/2014":"22.3333306",
      "07/16/2014":"22.4476163",
      "07/17/2014":"22.561902",
      "07/18/2014":"22.6761877",
      "07/19/2014":"22.7904734",
      "07/20/2014":"22.9047591",
      "07/21/2014":"23.0190448",
      "07/22/2014":"23.1333305",
      "07/23/2014":"23.2476162"
      }
  },

  {
      "Meta" : {
          "item_id" : "10",
          "Name":"CH FERMENT_4.FIC14601.OUT",
          "Location":"Chatham",
          "Area":"FERMENT_4",
          "Unit":"Unknown",
          "Number Type" : "Double Float",
          "Anything" : "Random4",
          "Description":"Chatham - FERMENT_4 - FIC14601.MEAS"
      },
      "data" :  {
      "01/01/2014":"0.00000001",
      "01/02/2014":"0.02",
      "01/03/2014":"0.03",
      "01/04/2014":"0.04",
      "01/05/2014":"0.05",
      "01/06/2014":"0.06",
      "01/07/2014":"0.07333333",
      "01/08/2014":"0.0847619",
      "01/09/2014":"0.09619047",
      "01/10/2014":"0.10761904",
      "01/11/2014":"0.11904761",
      "01/12/2014":"0.13047618",
      "01/13/2014":"0.14190475",
      "01/14/2014":"0.15333332",
      "01/15/2014":"0.16476189",
      "01/16/2014":"0.17619046",
      "01/17/2014":"0.18761903",
      "01/18/2014":"0.1990476",
      "01/19/2014":"0.21047617",
      "01/20/2014":"0.22190474",
      "01/21/2014":"0.23333331",
      "01/22/2014":"0.24476188",
      "01/23/2014":"0.25619045",
      "01/24/2014":"0.26761902",
      "01/25/2014":"0.27904759",
      "01/26/2014":"0.29047616",
      "01/27/2014":"0.30190473",
      "01/28/2014":"0.3133333",
      "01/29/2014":"0.32476187",
      "01/30/2014":"0.33619044",
      "01/31/2014":"0.34761901",
      "02/01/2014":"0.35904758",
      "02/02/2014":"0.37047615",
      "02/03/2014":"0.38190472",
      "02/04/2014":"0.39333329",
      "02/05/2014":"0.40476186",
      "02/06/2014":"0.41619043",
      "02/07/2014":"0.427619",
      "02/08/2014":"0.43904757",
      "02/09/2014":"0.45047614",
      "02/10/2014":"0.46190471",
      "02/11/2014":"0.47333328",
      "02/12/2014":"0.48476185",
      "02/13/2014":"0.49619042",
      "02/14/2014":"0.50761899",
      "02/15/2014":"0.51904756",
      "02/16/2014":"0.53047613",
      "02/17/2014":"0.5419047",
      "02/18/2014":"0.55333327",
      "02/19/2014":"0.56476184",
      "02/20/2014":"0.57619041",
      "02/21/2014":"0.58761898",
      "02/22/2014":"0.59904755",
      "02/23/2014":"0.61047612",
      "02/24/2014":"0.62190469",
      "02/25/2014":"0.63333326",
      "02/26/2014":"0.64476183",
      "02/27/2014":"0.6561904",
      "02/28/2014":"0.66761897",
      "03/01/2014":"0.67904754",
      "03/02/2014":"0.69047611",
      "03/03/2014":"0.70190468",
      "03/04/2014":"0.71333325",
      "03/05/2014":"0.72476182",
      "03/06/2014":"0.73619039",
      "03/07/2014":"0.74761896",
      "03/08/2014":"0.75904753",
      "03/09/2014":"0.7704761",
      "03/10/2014":"0.78190467",
      "03/11/2014":"0.79333324",
      "03/12/2014":"0.80476181",
      "03/13/2014":"0.81619038",
      "03/14/2014":"0.82761895",
      "03/15/2014":"0.83904752",
      "03/16/2014":"0.85047609",
      "03/17/2014":"0.86190466",
      "03/18/2014":"0.87333323",
      "03/19/2014":"0.8847618",
      "03/20/2014":"0.89619037",
      "03/21/2014":"0.90761894",
      "03/22/2014":"0.91904751",
      "03/23/2014":"0.93047608",
      "03/24/2014":"0.94190465",
      "03/25/2014":"0.95333322",
      "03/26/2014":"0.96476179",
      "03/27/2014":"0.97619036",
      "03/28/2014":"0.98761893",
      "03/29/2014":"0.9990475",
      "03/30/2014":"1.01047607",
      "03/31/2014":"1.02190464",
      "04/01/2014":"1.03333321",
      "04/02/2014":"1.04476178",
      "04/03/2014":"1.05619035",
      "04/04/2014":"1.06761892",
      "04/05/2014":"1.07904749",
      "04/06/2014":"1.09047606",
      "04/07/2014":"1.10190463",
      "04/08/2014":"1.1133332",
      "04/09/2014":"1.12476177",
      "04/10/2014":"1.13619034",
      "04/11/2014":"1.14761891",
      "04/12/2014":"1.15904748",
      "04/13/2014":"1.17047605",
      "04/14/2014":"1.18190462",
      "04/15/2014":"1.19333319",
      "04/16/2014":"1.20476176",
      "04/17/2014":"1.21619033",
      "04/18/2014":"1.2276189",
      "04/19/2014":"1.23904747",
      "04/20/2014":"1.25047604",
      "04/21/2014":"1.26190461",
      "04/22/2014":"1.27333318",
      "04/23/2014":"1.28476175",
      "04/24/2014":"1.29619032",
      "04/25/2014":"1.30761889",
      "04/26/2014":"1.31904746",
      "04/27/2014":"1.33047603",
      "04/28/2014":"1.3419046",
      "04/29/2014":"1.35333317",
      "04/30/2014":"1.36476174",
      "05/01/2014":"1.37619031",
      "05/02/2014":"1.38761888",
      "05/03/2014":"1.39904745",
      "05/04/2014":"1.41047602",
      "05/05/2014":"1.42190459",
      "05/06/2014":"1.43333316",
      "05/07/2014":"1.44476173",
      "05/08/2014":"1.4561903",
      "05/09/2014":"1.46761887",
      "05/10/2014":"1.47904744",
      "05/11/2014":"1.49047601",
      "05/12/2014":"1.50190458",
      "05/13/2014":"1.51333315",
      "05/14/2014":"1.52476172",
      "05/15/2014":"1.53619029",
      "05/16/2014":"1.54761886",
      "05/17/2014":"1.55904743",
      "05/18/2014":"1.570476",
      "05/19/2014":"1.58190457",
      "05/20/2014":"1.59333314",
      "05/21/2014":"1.60476171",
      "05/22/2014":"1.61619028",
      "05/23/2014":"1.62761885",
      "05/24/2014":"1.63904742",
      "05/25/2014":"1.65047599",
      "05/26/2014":"1.66190456",
      "05/27/2014":"1.67333313",
      "05/28/2014":"1.6847617",
      "05/29/2014":"1.69619027",
      "05/30/2014":"1.70761884",
      "05/31/2014":"1.71904741",
      "06/01/2014":"1.73047598",
      "06/02/2014":"1.74190455",
      "06/03/2014":"1.75333312",
      "06/04/2014":"1.76476169",
      "06/05/2014":"1.77619026",
      "06/06/2014":"1.78761883",
      "06/07/2014":"1.7990474",
      "06/08/2014":"1.81047597",
      "06/09/2014":"1.82190454",
      "06/10/2014":"1.83333311",
      "06/11/2014":"1.84476168",
      "06/12/2014":"1.85619025",
      "06/13/2014":"1.86761882",
      "06/14/2014":"1.87904739",
      "06/15/2014":"1.89047596",
      "06/16/2014":"1.90190453",
      "06/17/2014":"1.9133331",
      "06/18/2014":"1.92476167",
      "06/19/2014":"1.93619024",
      "06/20/2014":"1.94761881",
      "06/21/2014":"1.95904738",
      "06/22/2014":"1.97047595",
      "06/23/2014":"1.98190452",
      "06/24/2014":"1.99333309",
      "06/25/2014":"2.00476166",
      "06/26/2014":"2.01619023",
      "06/27/2014":"2.0276188",
      "06/28/2014":"2.03904737",
      "06/29/2014":"2.05047594",
      "06/30/2014":"2.06190451",
      "07/01/2014":"2.07333308",
      "07/02/2014":"2.08476165",
      "07/03/2014":"2.09619022",
      "07/04/2014":"2.10761879",
      "07/05/2014":"2.11904736",
      "07/06/2014":"2.13047593",
      "07/07/2014":"2.1419045",
      "07/08/2014":"2.15333307",
      "07/09/2014":"2.16476164",
      "07/10/2014":"2.17619021",
      "07/11/2014":"2.18761878",
      "07/12/2014":"2.19904735",
      "07/13/2014":"2.21047592",
      "07/14/2014":"2.22190449",
      "07/15/2014":"2.23333306",
      "07/16/2014":"2.24476163",
      "07/17/2014":"2.2561902",
      "07/18/2014":"2.26761877",
      "07/19/2014":"2.27904734",
      "07/20/2014":"2.29047591",
      "07/21/2014":"2.30190448",
      "07/22/2014":"2.31333305",
      "07/23/2014":"2.32476162"
      }
  }
  ];


  $scope.filesMetaData = [];

  $scope.stepOne = false;
  $scope.stepTwo = false;
  $scope.selection = true;
  $scope.fieldsData = {};
  $scope.confirmation =false;
  $scope.fieldDetails = [
  {
    detailName : "Number Type",
    options : ["Int", "Float1", "Float2"]
  },
  {
    detailName : "Unit",
    options : ["meter", "centimeter", "litre"]
  },
  {
    detailName : "Anything",
    options : ["random1", "random2", "random3"]
  }];

  $scope.menuFieldDetail = {
    fieldType : {value : ""},
    fieldName : {value : ""},
    fieldUploader : {value : $scope.uploader}
  };

  $scope.selectedFields = {value : ""};

  $scope.realData = $scope.formattedData[0].data;
  $scope.headers = ['Date', $scope.formattedData[0].Meta.Name];






  $scope.submitUpload = function(){
    var itemnum = {};
		itemnum.sizeofupload = $scope.uploader.queue.length;

		$http.post("http://10.3.86.65:3000/itemnum", itemnum).success(function(){
			console.log("size success");
			for (var i = 0; i < $scope.uploader.queue.length; i ++){
				var item = $scope.uploader.queue[i];
				item.formData = [{ type : $scope.menuFieldDetail.fieldType.value}, {name : $scope.menuFieldDetail.fieldName.value}];
				item.upload();
				item.onSuccess = function(response){
					console.log(response);
					uploadSocket.emit("stepOne");
				};
			}
    });
  };

  uploadSocket.on("stepOne", function(data){
		data = eval(data);
		$scope.filesMetaData = data[0];
    console.log($scope.filesMetaData);

    var fileName = $scope.filesMetaData.filename;
    var fields = data[1];
    daveFormatService.selectionFieldsDataDFS($scope.fieldsData,fileName, fields);
    console.log($scope.fieldsData);

    $scope.stepOne = true;
	});

  $scope.$on("Decided", function(event, data){
    console.log(data);

    $scope.selectedFields = data;
  });

  $scope.$on("Canceled", function(event){

    $scope.selectedFields = "";
  });

  $scope.$on("Submit", function(event){
    var fakeData = [];
    fakeData.push($scope.selectedFields);
    uploadSocket.emit("stepTwo", fakeData);

    $scope.stepOne = false;
    $scope.stepTwo = true;

    $scope.selection = false;
    $scope.confirmation = true;

  });

  $scope.$on("Confirm", function(event, data){
    $scope.realData = JSON.parse(data[2]);
    console.log("realData : " + $scope.realData);
    $scope.headers[0] = data[0];
    $scope.headers[1] = data[1];
  });

  $scope.$on("Close Others", function(event){
    $scope.$broadcast("Close", event.targetScope);
  });
}]);

/*importer.run(['$http', function($http){
  username = {username : prompt("Please input your username.")};
  $http.post('http:///10.3.86.65:3000/username', username).success(function() {
    console.log("success!");
  }).
  error(function(status) {
    console.log(status);
  });
}]);*/
